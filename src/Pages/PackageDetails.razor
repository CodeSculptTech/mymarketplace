@page "/details/{identifier}/{version}"
@inject ExtensionClient Client
@inject HttpClient http
@inject NavigationManager Navigator
@using System.Net

@code {
    [Parameter]
    public string? Identifier { get; set; }

    [Parameter]
    public string? Version { get; set; }

    [CascadingParameter]
    public IEnumerable<ExtensionPackage>? Packages { get; set; }    

    protected override async Task OnParametersSetAsync()
    {
        await LoadPackages();
    }

    private string ReadmeContent { get; set; } = string.Empty;
    private List<string>? versions;

    async Task LoadPackages()
    {
        if (Identifier is not null && Version is not null)
        {
            var allPackages = (await Client.GetExtensionDetailsAsync(Identifier));
            versions = allPackages.Select(x => x.Version).Distinct().ToList();
            Packages = allPackages.Where(x => x.Identifier == Identifier && x.Version == Version);

            http.BaseAddress = new Uri(Navigator.BaseUri);
            ReadmeContent = await http.GetStringAsync(Packages.First().Extensions[0].ReadmePath);
        }
    }

    void VersionSelected(string version)
    {
        Version = version;
        Navigator.NavigateTo($"/details/{Identifier}/{version}", true);
    }
}
<PageTitle>My Marketplace - Package Detail</PageTitle>

<CascadingValue Value="@Packages">
    <PackageList />

    <Divider />

    <Space Direction="DirectionVHType.Horizontal" Style="gap:8px">
        <Text>Version(s):</Text>
        <DropdownButton>
            <ChildContent>@Version</ChildContent>
            <Overlay>
                <Menu Selectable DefaultSelectedKeys="@(new[] {@Version})" OnMenuItemClicked="@((mi)=>VersionSelected(mi.Key))">
                    @foreach (var version in versions)
                    {
                        <MenuItem Key="@version">@version</MenuItem>
                    }
                </Menu>
            </Overlay>
        </DropdownButton>
    </Space>

    <Divider />

    <Readme ReadmeContent="@ReadmeContent" />

</CascadingValue>